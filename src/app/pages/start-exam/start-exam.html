<div class="bg-zinc-100 min-h-screen py-10">
    <div class="mx-auto max-w-7xl grid grid-cols-12 gap-8 px-6">
        <!-- DANH SÁCH CÂU HỎI -->
        <div class="col-span-9">
            @if (questions().length > 0) {
            <div class="mx-auto">
                <form>
                    @for (q of questions(); track $index) {
                    <div
                        class="mb-8 p-6 rounded-2xl bg-white/70 backdrop-blur-md border border-white/40 shadow-sm"
                    >
                        <p class="font-semibold text-lg text-zinc-900 mb-4">
                            Câu {{ $index + 1 }}: {{ q.content }}
                        </p>

                        @for (a of q.answers; track $index) {
                        <label
                            class="flex items-center gap-3 p-3 mb-2 rounded-xl cursor-pointer transition-all duration-150 hover:bg-zinc-100"
                            [ngClass]="{
                                'bg-green-200/70 border border-green-300':
                                    submitted && a.is_correct,
                                'bg-red-200/70 border border-red-300':
                                    submitted && selectedAnswers[q.id] === a.id && !a.is_correct
                            }"
                        >
                            <input
                                type="radio"
                                [name]="'q' + q.id"
                                [value]="a.id"
                                [(ngModel)]="selectedAnswers[q.id]"
                                [disabled]="submitted"
                                class="h-4 w-4 accent-blue-500"
                            />
                            <span class="text-zinc-800">
                                {{ a.content }}
                            </span>
                        </label>
                        }
                    </div>
                    } @if (!submitted) {
                    <button
                        type="button"
                        class="btn-primary mt-6 inline-flex items-center justify-center px-8 py-3 text-base font-medium"
                        (click)="submit()"
                    >
                        {{ 'startExam.submit' | translate }}
                    </button>
                    }
                </form>

                <!-- KẾT QUẢ -->
                @if (submitted) {
                <div
                    class="mt-8 p-6 rounded-2xl bg-white/70 backdrop-blur-md border border-white/40 shadow-sm"
                >
                    <p class="text-xl font-semibold text-zinc-900 mb-3">
                        {{ 'startExam.resultTitle' | translate }}
                    </p>

                    <p class="text-zinc-700">
                        {{ 'startExam.score' | translate }}:
                        <strong class="text-blue-500">{{ score }}/10</strong>
                    </p>

                    <p class="text-zinc-700 mt-1">
                        {{ 'startExam.correctCount' | translate }}:
                        <strong class="text-green-500">{{ correctCount }}</strong>
                        / {{ questions().length }}
                    </p>
                </div>
                }
            </div>

            } @else {
            <div class="text-center text-xl font-medium py-24 text-zinc-500">
                {{ 'startExam.noQuestion' | translate }}
            </div>
            }
        </div>

        <!-- SIDEBAR CẤU HÌNH -->
        <div
            class="col-span-3 h-fit rounded-2xl bg-white/70 backdrop-blur-md border border-white/40 shadow-sm p-6"
        >
            <h2 class="text-xl font-semibold text-zinc-900 mb-6">
                {{ 'startExam.sidebarTitle' | translate }}
            </h2>

            <div class="mb-6">
                <label class="block text-sm font-medium text-zinc-700 mb-1">
                    {{ 'startExam.questionCount' | translate }}
                </label>
                <input
                    type="number"
                    class="w-full rounded-xl border border-zinc-300 bg-white/80 px-3 py-2 focus:outline-none focus:ring-2 focus:ring-blue-400"
                    [ngModel]="totalQuestionPerExam()"
                    (ngModelChange)="onInputTotalQuestionPerExam($event)"
                />
            </div>

            <button
                (click)="onRandomQuestions()"
                class="btn-primary w-full px-4 py-3 text-base font-medium"
            >
                {{ 'startExam.random' | translate }}
            </button>
        </div>
    </div>
</div>
